# Installing the extension

## Chrome

1. Go to `chrome://extensions/`
1. Turn on `Developer Mode`
1. Click `Load Unpacked`
1. Pick `extension` directory in this repo
1. Go to `Details` for the extension -> Turn off `Collect Errors`

## Firefox / Zen Browser (Development - Temporary)

1. Run `bun run dev:zen` (opens browser with auto-reloading extension)
1. Click `Load Temporary Add-on` (if not auto-loaded)
1. Select `manifest.json` from the `extension` directory

**Note:** Temporary add-ons are removed when you close the browser. For persistent installation, see below.

## Firefox / Zen Browser (Permanent Installation)

For a permanent installation that survives browser restarts and updates:

### First-time setup:

1. Go to [Mozilla Add-ons Developer Hub](https://addons.mozilla.org/developers/)
2. Sign in or create an account
3. Navigate to [API Credentials](https://addons.mozilla.org/developers/addon/api/key/)
4. Click "Generate new credentials" or "Create new API credentials"
5. Copy the `JWT issuer` and `JWT secret`
6. Create a `.env` file in the project root (see `env.signing.example` for reference):

```bash
AMO_JWT_ISSUER=user:12345678:123
AMO_JWT_SECRET=your-secret-key-here
```

### Build and sign the extension:

```bash
bun run build
```


### Install the signed extension:

1. Open Zen Browser
2. Go to `about:addons`
3. Click the gear icon ⚙️ → "Install Add-on From File..."
4. Select the `.xpi` file we just built
5. Confirm the installation

The extension will now persist across browser restarts and updates.

### Updating the extension:

```bash
bun run build
```

Then install the new `.xpi` file in Zen Browser (it will update the existing installation).

# Safari (Local, via Safari Web Extension)

Safari requires wrapping the web extension in a small macOS app (generated by Apple’s converter).

### First-time setup (generate Xcode project)

```bash
bun run safari:sync
bun run safari:init
```

This creates a local Xcode project under `.safari/xcode` (ignored by git).

### Build (and rebuild after changes)

```bash
bun run safari:dev
```

That command:
- Builds `extension/dist/*`
- Syncs a Safari-safe web extension source (excluding `extension/signed/`)
- Builds the macOS app via `xcodebuild`

The output prints the built `.app` path. Open that app once, then in Safari go to `Safari -> Settings -> Extensions` and enable the extension.

### Customizing the generated app

You can override the default app name / bundle id:

```bash
SAFARI_APP_NAME="Fantasy Basketball Automation" SAFARI_BUNDLE_ID_PREFIX="com.yourname" bun run safari:dev
```

# Reference

## To run automatically on page load

The extension is configured in `manifest.json` to run automatically:

```json
"content_scripts": [
    {
      "matches": [
        "https://www.fleaflicker.com/nba/leagues/30579/teams/161025*"
      ],
      "js": ["dist/page-load__set-lineup.js"]
    }
  ]
```

Update the `matches` pattern to your league/team URL. The `*` wildcard allows it to run on all pages within that team.
